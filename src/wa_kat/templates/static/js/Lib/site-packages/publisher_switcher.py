#! /usr/bin/env python
# -*- coding: utf-8 -*-
#
# Interpreter version: brython (http://brython.info) (like python3)
#
# Imports =====================================================================
from browser import document

from descriptors import StandardElDescriptor


# Variables ===================================================================
PUBLISHER_EL = document["whole_publisher"]
SWITCHER_EL = document["publisher_switcher"]


# Functions & classes =========================================================
def show_publisher(ev=None):
    PUBLISHER_EL.style.display = "block"

    SWITCHER_EL.checked = True
    SWITCHER_EL.bind("change", hide_publisher)


def hide_publisher(ev=None):
    PUBLISHER_EL.style.display = "none"

    SWITCHER_EL.checked = False
    SWITCHER_EL.bind("change", show_publisher)


hide_publisher()
SWITCHER_EL.bind("change", show_publisher)


class PublisherDescriptor(StandardElDescriptor):
    def __init__(self):
        super(self.__class__, self).__init__(document["publisher"])

    def __set__(self, obj, value):
        if value:
            show_publisher()

        super(self.__class__, self).__set__(obj, value)

    def validate(self):
        if not SWITCHER_EL.checked:
            return True

        return super(self.__class__, self).validate()

    def __get__(self, *args, **kwargs):
        if not SWITCHER_EL.checked:
            return None

        return super(self.__class__, self).__get__(*args, **kwargs)
